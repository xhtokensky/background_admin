webpackJsonp([14],{KMEl:function(e,t){},KY24:function(e,t){},W3fF:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={props:{bodyArr:Array,default_checked_keys:Array,isTabelPermiss:{type:Number,defalult:0}},computed:{data2:function(){return this.bodyArr}},data:()=>({check_strictly:!0,getCheckedNodes:null,defaultProps:{children:"child",label:"name"},allWrapIdArr:[]}),methods:{getCheckedKeys(e,t,s){var r=[];return function e(a,i){var c=[];for(var l=0;l<a.length;l++){var d=a[l];c[l]=!1,d.child&&(c[l]=!!e(d.child,!0)||c[l],c[l]&&r.push(d[s]));for(var o=0;o<t.length;o++)if(d[s]==t[o]){c[l]=!0,-1==r.indexOf(d[s])&&r.push(d[s]);break}}if(i)return-1!=c.indexOf(!0)}(e,!1),r},cancel(){this.$router.push({path:"/role"})},handleNodeClick(){this.getCheckedNodes=[];this.$refs.tree.getHalfCheckedKeys();let e=[];this.$refs.tree.getCheckedNodes().forEach(t=>{e.push(t.id)}),this.getCheckedNodes=e},submit(){console.log(this.getCheckedNodes),this.$emit("treeSubmit",this.getCheckedNodes)}}},a={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-tree",{ref:"tree",attrs:{data:e.data2,"check-strictly":e.check_strictly,props:e.defaultProps,"default-checked-keys":e.default_checked_keys,"node-key":"id","show-checkbox":""},on:{"check-change":e.handleNodeClick}}),e._v(" "),s("div",{staticClass:"submit  dcp permissBtn",on:{click:e.cancel}},[e._v("取消")]),e._v(" "),s("div",{staticClass:"submit  dcp permissBtn",on:{click:e.submit}},[e._v("提交授权")])],1)},staticRenderFns:[]};var i=s("C7Lr")(r,a,!1,function(e){s("KY24")},"data-v-522e93ba",null).exports,c={components:{position:s("t/xR").a,treeInput:i},inject:["reload"],data:()=>({accessList:[],roleInfo:null,default_checked_keys:[]}),mounted(){let e=this;e.$route.params&&Object.keys(e.$route.params).length>0?(e.roleInfo=e.$route.params.data,e.getAccessList(),e.roleGetPermission()):e.$router.push({path:"/role"})},methods:{roleGetPermission(){let e=this,t=e.$api+"admin/resource/treeGridByRole",s={id:e.roleInfo.id};e.$axios.post(t,s).then(t=>{if(t.data&&0==t.data.code){let s=t.data.content,r={};for(let e=0;e<s.length;e++)if(s[e].child&&s[e].child.length>0){let t=s[e].child;for(let e=0;e<t.lengthl;e++)if(t.child&&t.child.length>0){let e=t.child;for(let t=0;t<e.length>0;t++)r[`${e[t].id}`]=1}else r[`${t[e].id}`]=1}else r[`${s[e].id}`]=1;let a=Object.keys(r);for(let e=0;e<a.length>0;e++)a[e]=parseInt(a[e]);e.default_checked_keys=a}else this.$message({message:t.data.result,type:"error"})})},treeSubmit(e){let t=this,s={id:t.roleInfo.id.toString(),ids:e.toString()},r=t.$api+"admin/role/allocate";t.$axios.post(r,s).then(e=>{e.data&&0==e.data.code?(this.$message({message:e.data.msg,type:"success"}),t.$router.push({path:"role"})):this.$message({message:e.data.msg,type:"error"})})},getAccessList(){let e=this,t=this.$api+"admin/resource/treegrid";e.$axios.get(t).then(t=>{if(t.data&&0==t.data.code){let s=t.data.content;e.accessList=s}else this.$message({message:t.data.result,type:"error"})})}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"vc uservc"},[s("position",{attrs:{title:"系统设置 > 角色授权"}}),e._v(" "),s("div",{staticClass:"ctt"},[e.roleInfo?s("div",{staticClass:"role"},[e._v("\n\t\t\t"+e._s(e.roleInfo.roleName)+"\n\t\t")]):e._e(),e._v(" "),s("div",{staticClass:"treeWrap userMngView dafter_ctt_dspBlock_clearBoth"},[e.accessList.length>0?s("treeInput",{attrs:{bodyArr:e.accessList,default_checked_keys:e.default_checked_keys},on:{treeSubmit:e.treeSubmit}}):e._e()],1)])],1)},staticRenderFns:[]};var d=s("C7Lr")(c,l,!1,function(e){s("KMEl")},"data-v-5e8cec56",null);t.default=d.exports}});