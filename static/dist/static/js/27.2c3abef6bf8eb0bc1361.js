webpackJsonp([27],{"0pck":function(e,t){},DtfX:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("t/xR"),a={props:{titleArr:{type:Array,default:[]},bodyArr:{type:Array,default:[]}},mounted(){console.log(this.bodyArr)},computed:{permiss(){return this.$store.getters.permiss},addIf(){return this.permiss[`${this.$route.name}`]}},methods:{eduitClick(e,t,s){this.$emit("permissions_eduit",e,t,s)},deleteClick(e,t,s){let i=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{i.$emit("permissions_delete",e,t,s)}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},getLength:e=>""==e[0]?0:e.length,setFlex:e=>0==e?"dflex1 rightMove":2==e||4==e?"dflex2":"dflex1",liClick(e){this.$emit("liClick",e)}}},l={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"table1"},[s("div",{staticClass:"table_headv ddspflex_flexRow_jstCenter_aliCenter"},e._l(e.titleArr,function(t,i){return s("div",{key:i,class:e.setFlex(i)},[e._v(e._s(t.text))])}),0),e._v(" "),s("div",{staticClass:"table_body"},e._l(e.bodyArr,function(t,i){return s("div",{key:i,staticClass:"table_row",staticStyle:{border:"1px solid rgba(0,0,0,.2)","margin-bottom":".1rem"}},[s("div",[s("div",{staticClass:"ddspflex_flexRow_jstCenter_aliCenter",staticStyle:{"background-color":"#EDECEC"}},[s("div",{staticClass:"dflex1 rightMove",staticStyle:{"font-size":".2rem","font-weight":"600"}},[e._v(e._s(t.name))]),e._v(" "),null==t.parent?s("div",{staticClass:"dflex1"},[e._v("模块")]):e._e(),e._v(" "),t.linkUrl?s("div",{staticClass:"dflex2"},[e._v(e._s(t.linkUrl))]):s("div",{staticClass:"dflex2"},[e._v("-")]),e._v(" "),t.seq?s("div",{staticClass:"dflex1"},[e._v(e._s(t.seq))]):s("div",{staticClass:"dflex1"},[e._v("-")]),e._v(" "),s("div",{staticClass:"dflex2"},[e.addIf&&e.addIf.edit&&"edit"==e.addIf.edit?s("span",{staticClass:"tb_ope_btn eduitBtn",on:{click:function(t){return e.eduitClick(i,null,null)}}},[e._v("编辑")]):e._e(),e._v(" "),e.addIf&&e.addIf.delete&&"delete"==e.addIf.delete?s("span",{staticClass:"tb_ope_btn deleteBtn",on:{click:function(t){return e.deleteClick(i,null,null)}}},[e._v("删除")]):e._e()])]),e._v(" "),e._l(t.child,function(a,l){return s("div",{key:l,staticClass:" ",on:{click:function(s){return e.liClick(t.hash)}}},[s("div",[s("div",{staticClass:"menuView ddspflex_flexRow_jstCenter_aliCenter",staticStyle:{"background-color":"#FFFFFF"}},[s("div",{staticClass:"dflex1 rightMove",staticStyle:{"font-size":".18rem","font-weight":"600"}},[e._v(e._s("--"+a.name))]),e._v(" "),0==a.permissionParentId?s("div",{staticClass:"dflex1"},[e._v("模块")]):s("div",{staticClass:"dflex1"},[e._v("---菜单")]),e._v(" "),a.linkUrl?s("div",{staticClass:"dflex2"},[e._v(e._s(a.linkUrl))]):s("div",{staticClass:"dflex2"},[e._v("-")]),e._v(" "),a.seq?s("div",{staticClass:"dflex1"},[e._v(e._s(a.seq))]):s("div",{staticClass:"dflex1"},[e._v("-")]),e._v(" "),s("div",{staticClass:"dflex2"},[e.addIf&&e.addIf.edit&&"edit"==e.addIf.edit?s("span",{staticClass:"tb_ope_btn eduitBtn",on:{click:function(t){return e.eduitClick(i,l,null)}}},[e._v("编辑")]):e._e(),e._v(" "),e.addIf&&e.addIf.delete&&"delete"==e.addIf.delete?s("span",{staticClass:"tb_ope_btn deleteBtn",on:{click:function(t){return e.deleteClick(i,l,null)}}},[e._v("删除")]):e._e()])]),e._v(" "),e._l(a.child,function(a,d){return a.method?e._e():s("div",{key:d,staticClass:"btnNodeView ddspflex_flexRow_jstCenter_aliCenter",staticStyle:{"background-color":"rgba(248,248,248,1)"},on:{click:function(s){return e.liClick(t.hash)}}},[s("div",{staticClass:"dflex1 rightMove",staticStyle:{"font-size":".16rem","font-weight":"600"}},[e._v(e._s("----"+a.name))]),e._v(" "),0==a.permissionParentId?s("div",{staticClass:"dflex1"},[e._v("模块")]):s("div",{staticClass:"dflex1"},[e._v("------按钮")]),e._v(" "),a.linkUrl?s("div",{staticClass:"dflex2"},[e._v(e._s(a.linkUrl))]):s("div",{staticClass:"dflex2"},[e._v("-")]),e._v(" "),a.seq?s("div",{staticClass:"dflex1"},[e._v(e._s(a.seq))]):s("div",{staticClass:"dflex1"},[e._v("-")]),e._v(" "),s("div",{staticClass:"dflex2"},[e.addIf&&e.addIf.edit&&"edit"==e.addIf.edit?s("span",{staticClass:"tb_ope_btn eduitBtn dcp",on:{click:function(t){return e.eduitClick(i,l,d)}}},[e._v("编辑")]):e._e(),e._v(" "),e.addIf&&e.addIf.delete&&"delete"==e.addIf.delete?s("span",{staticClass:"tb_ope_btn deleteBtn dcp",on:{click:function(t){return e.deleteClick(i,l,d)}}},[e._v("删除")]):e._e()])])})],2)])})],2)])}),0)])},staticRenderFns:[]};var d=s("C7Lr")(a,l,!1,function(e){s("XNdh")},"data-v-1e6758b9",null).exports,r={name:"logfound",props:{dialog:Object,form:Object,modules:Array},data:()=>({permissionId:null,menus:[],permissionName:null,selectPermissionParentId:null,moduleId:"顶级模块",menuId:"顶级菜单",path:null,sort:null,note:null,form_rules:{permissionName:[{required:!0,message:"权限名称不能为空",trigger:"blur"}],path:[{required:!0,message:"路径不能为空！",trigger:"blur"}]}}),mounted(){},watch:{form:function(e){this.moduleChange()}},methods:{closeClick(){this.dialog.show=!1},moduleChange(){let e=this;if(!e.form.moduleId)return;let t=this.$base_url+"permission?permissionId="+e.form.moduleId;e.$axios.get(t).then(t=>{t.data&&0==t.data.resultCode&&t.data&&t.data.content&&(e.menus=t.data.content.data)})},onSubmit(){let e=this;if(!e.form.permissionName)return void e.$message({showClose:!0,message:"名称 不能为空"});let t={permissionName:e.form.permissionName,path:e.form.path};e.form.moduleId&&(t.permissionParentId=e.form.moduleId),e.form.menuId&&(t.permissionParentId=e.form.menuId),e.form.path||(t.isMenu=1),e.form.sort&&(t.sort=e.form.sort);let s=e.$base_url+"permission";"add"==this.dialog.option&&e.$axios.post(s,t).then(e=>{e.data&&0==e.data.resultCode?this.$message({message:"新增成功",type:"success"}):this.$message({message:e.data.result,type:"error"}),this.dialog.show=!1,this.$emit("update")}),"eduit"==this.dialog.option&&(t.permissionId=e.form.permissionId,e.$axios.put(s,t).then(e=>{e.data&&0==e.data.resultCode?(this.$message({message:"修改成功",type:"success"}),this.dialog.show=!1,this.$emit("update")):this.$message({message:e.data.result,type:"error"})}))}}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"logFund"},[s("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.show,"close-on-click-modal":!1,"close-on-press-escape":!1,"modal-append-to-body":!1},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[s("div",{staticClass:"form"},[s("el-form",{ref:"form",staticStyle:{margin:"10px",width:"auto"},attrs:{model:e.form,rules:e.form_rules,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"权限名称:"}},[s("el-input",{attrs:{type:"permissionName",placeHolder:"权限名称"},model:{value:e.form.permissionName,callback:function(t){e.$set(e.form,"permissionName",t)},expression:"form.permissionName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"节点类型:"}},[s("el-select",{on:{change:function(t){return e.moduleChange(e.value)}},model:{value:e.form.moduleId,callback:function(t){e.$set(e.form,"moduleId",t)},expression:"form.moduleId"}},[s("el-option",{attrs:{label:"区域",vlaue:"0"}}),e._v(" "),s("el-option",{attrs:{label:"菜单",vlaue:"1"}}),e._v(" "),s("el-option",{attrs:{label:"按钮",vlaue:"2"}})],1)],1),e._v(" "),e.form.showSelect?s("el-form-item",{attrs:{label:"父节点:"}},[e.modules?s("el-select",{attrs:{placeholder:"模块信息"},on:{change:function(t){return e.moduleChange(e.value)}},model:{value:e.form.moduleId,callback:function(t){e.$set(e.form,"moduleId",t)},expression:"form.moduleId"}},e._l(e.modules,function(e,t){return s("el-option",{key:t,attrs:{label:e.permissionName,value:e.permissionId}})}),1):e._e()],1):e._e(),e._v(" "),e.form.moduleId?s("el-form-item",{attrs:{label:"页面路径:"}},[s("el-input",{attrs:{type:"path",placeHolder:"页面路径"},model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"导航顺序:"}},[s("el-input",{attrs:{type:"path",placeHolder:"目录上下顺序"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit(t)}},model:{value:e.form.sort,callback:function(t){e.$set(e.form,"sort",t)},expression:"form.sort"}})],1),e._v(" "),s("el-form-item",{staticClass:"text_right"},[s("el-button",{on:{click:e.closeClick}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("提 交")])],1)],1)],1)])],1)},staticRenderFns:[]},o=s("C7Lr")(r,n,!1,null,null,null).exports,c={components:{position:i.a,accessTb:d,DialogAdd:o},data:()=>({modules:null,titleArr:[{text:"模块名称"},{text:"区域"},{text:"路径"},{text:"导航排序"},{text:"操作"}],accessList:[],currentPage4:1,tableData:[],allTableData:[],filterTableData:[],dialog:{show:!1,title:"",option:"edit"},form:{permissionName:"",moduleId:"",menuId:"",path:"",sort:""},paginations:{page_index:1,total:0,page_size:5,page_sizes:[5,10,15,20],layout:"total, sizes, prev, pager, next, jumper"},search_data:{startTime:"",endTime:""}}),created(){},computed:{permiss(){return this.$store.getters.permiss},addIf(){return this.permiss[`${this.$route.name}`]}},mounted(){this.getAccessList()},methods:{permissions_eduit(e,t,s){let i=this;if(null!=s){let a={};a.name=i.accessList[e].child[t].child[s].name,a.rtype=i.accessList[e].child[t].child[s].rtype,a.id=i.accessList[e].child[t].child[s].id,a.parentId=i.accessList[e].child[t].id,a.btnText=i.accessList[e].child[t].name,a.seq=i.accessList[e].child[t].child[s].seq,a.UrlFor=i.accessList[e].child[t].child[s].UrlFor,a.linkUrl=i.accessList[e].child[t].child[s].linkUrl,this.$router.push({name:"accessEdu",params:a})}else if(null!=t){let s={};s.name=i.accessList[e].child[t].name,s.rtype=i.accessList[e].child[t].rtype,s.id=i.accessList[e].child[t].id,s.parentId=i.accessList[e].id,s.btnText=i.accessList[e].name,s.seq=i.accessList[e].child[t].seq,s.UrlFor=i.accessList[e].child[t].UrlFor,s.linkUrl=i.accessList[e].child[t].linkUrl,this.$router.push({name:"accessEdu",params:s})}else{let t={};t.name=i.accessList[e].name,t.rtype=i.accessList[e].rtype,t.id=i.accessList[e].id,t.parentId=0,t.btnText="顶级模块",t.seq=i.accessList[e].seq,t.UrlFor=i.accessList[e].UrlFor,t.linkUrl=i.accessList[e].linkUrl,this.$router.push({name:"accessEdu",params:t})}},permissions_delete(e,t,s){let i=this,a=this.$api+"admin/resource/delete",l={};l.id=null!=s?i.accessList[e].child[t].child[s].id:null!=t?i.accessList[e].child[t].id:i.accessList[e].id,i.$axios.post(a,l).then(e=>{e.data&&0==e.data.code?(this.$message({message:e.data.msg,type:"success"}),i.getAccessList()):this.$message({message:e.data.msg,type:"error"})})},getAccessList(){let e=this,t=this.$api+"admin/resource/treegrid";e.$axios.get(t).then(t=>{t.data&&0==t.data.code?(e.accessList=t.data.content,e.modules=t.data.content):this.$message({message:t.data.result,type:"error"})})},onEditMoney(e){this.dialog={show:!0,title:"修改资金信息",option:"edit"},this.form={type:e.type,describe:e.describe,income:e.income,expend:e.expend,cash:e.cash,remark:e.remark,id:e._id}},onDeleteMoney(e,t){this.$axios.delete(`/api/profile/delete/${e._id}`).then(e=>{this.$message("删除成功"),this.getProfile()})},addEv(){this.$router.push({path:"accessEdu"})},handleCurrentChange(e){let t=this.paginations.page_size*(e-1),s=this.allTableData.filter((e,s)=>s>=t);this.tableData=s.filter((e,t)=>t<this.paginations.page_size)},handleSizeChange(e){this.paginations.page_index=1,this.paginations.page_size=e,this.tableData=this.allTableData.filter((t,s)=>s<e)},setPaginations(){this.paginations.total=this.allTableData.length,this.paginations.page_index=1,this.paginations.page_size=5,this.tableData=this.allTableData.filter((e,t)=>t<this.paginations.page_size)},onScreeoutMoney(){if(!this.search_data.startTime||!this.search_data.endTime)return this.$message({type:"warning",message:"请选择时间区间"}),void this.getProfile();const e=this.search_data.startTime.getTime(),t=this.search_data.endTime.getTime();this.allTableData=this.filterTableData.filter(s=>{let i=new Date(s.date).getTime();return i>=e&&i<=t}),this.setPaginations()}}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"vc uservc"},[s("position",{attrs:{title:"权限管理 > 资源管理"}}),e._v(" "),s("div",{staticClass:"ctt"},[e.addIf&&e.addIf.edit&&"edit"==e.addIf.edit?s("div",{staticClass:"title dafter_ctt_dspBlock_clearBoth"},[s("div",{staticClass:"dfr addBtn",staticStyle:{color:"rgb(0, 135, 204)"},on:{click:function(t){return e.addEv()}}},[e._v("添加权限")])]):e._e(),e._v(" "),s("div",{staticClass:"userMngView dafter_ctt_dspBlock_clearBoth"},[e.accessList.length>0?s("accessTb",{attrs:{titleArr:e.titleArr,bodyArr:e.accessList},on:{permissions_eduit:e.permissions_eduit,permissions_delete:e.permissions_delete}}):e._e()],1)]),e._v(" "),e.modules?s("DialogAdd",{attrs:{dialog:e.dialog,form:e.form,modules:e.modules},on:{update:e.getAccessList}}):e._e()],1)},staticRenderFns:[]};var u=s("C7Lr")(c,m,!1,function(e){s("0pck")},"data-v-1cc5ff2c",null);t.default=u.exports},XNdh:function(e,t){}});